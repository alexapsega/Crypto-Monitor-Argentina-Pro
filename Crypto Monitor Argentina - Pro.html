<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Monitor Argentina - V6</title>
    <style>
        :root {
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --clock-color: #38bdf8;
            --up-color: #4ade80;
            --down-color: #f87171;
            --input-bg: #334155;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* --- RELOJ Y FECHA --- */
        .clock-container {
            margin-bottom: 30px;
            background: var(--card-bg);
            padding: 15px 40px;
            border-radius: 15px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
            border: 1px solid #334155;
            min-width: 320px;
            
            /* Flex para alinear fecha a la izquierda del reloj */
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px; 
        }

        .time {
            font-size: 3rem;
            font-weight: 700;
            font-variant-numeric: tabular-nums;
            color: var(--clock-color);
            text-shadow: 0 0 15px rgba(56, 189, 248, 0.3);
            line-height: 1;
        }

        .milliseconds { font-size: 1.2rem; color: var(--text-secondary); opacity: 0.8; }

        /* Estilo "Fantasma" para la fecha */
        .date-display {
            font-size: 1.2rem;
            font-weight: 300; /* Letra fina */
            color: #94a3b8;   /* Gris azulado */
            opacity: 0.4;     /* Muy transparente */
            text-transform: uppercase;
            letter-spacing: 1px;
            text-align: right;
            line-height: 1.2;
            /* Efecto suave/difuminado */
            filter: blur(0.3px); 
            transition: opacity 0.3s;
        }

        .date-display:hover {
            opacity: 0.8;     /* Se ilumina un poco si pasas el mouse */
            filter: blur(0px);
        }

        /* --- GRID PRINCIPAL --- */
        .crypto-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            width: 100%;
            max-width: 1200px;
            margin-bottom: 40px;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
            border: 1px solid #334155;
            display: flex;
            flex-direction: column;
            min-height: 250px;
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #334155;
        }

        select.coin-selector {
            background: var(--input-bg);
            color: white;
            border: 1px solid #475569;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            outline: none;
            width: 60%;
            text-transform: uppercase;
        }
        
        .trend-badge {
            font-size: 0.85rem;
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 6px;
            background: rgba(255,255,255,0.05);
            min-width: 80px;
            text-align: center;
        }
        .trend-up { color: var(--up-color); border: 1px solid var(--up-color); }
        .trend-down { color: var(--down-color); border: 1px solid var(--down-color); }
        .trend-neutral { color: var(--text-secondary); border: 1px solid var(--text-secondary); }

        /* Estilos de Filas */
        .exchange-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 8px 12px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
        }

        .exchange-name {
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .price-group { text-align: right; }
        
        /* Precios */
        .price-val { font-variant-numeric: tabular-nums; letter-spacing: 0.5px; }
        .price-usd { font-size: 0.85rem; color: #4ade80; margin-top: 2px;}
        .price-ars { font-size: 1.1rem; font-weight: bold; color: var(--text-primary); }
        
        .currency-suffix { font-size: 0.7em; margin-left: 4px; opacity: 0.7; font-weight: normal; }

        /* Caja Satoshi */
        .satoshi-box {
            margin-top: auto;
            padding: 10px;
            background: rgba(247, 147, 26, 0.1);
            border: 1px solid rgba(247, 147, 26, 0.3);
            border-radius: 10px;
            text-align: center;
            display: none;
        }
        .satoshi-box.visible { display: block; }
        .satoshi-title { color: #f7931a; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px; }
        .satoshi-values { font-size: 0.9rem; font-weight: bold; margin-top: 5px; }

        /* --- CALCULADORA --- */
        .calculator-section {
            width: 100%;
            max-width: 900px;
            background: var(--card-bg);
            padding: 25px;
            border-radius: 16px;
            border: 1px solid #334155;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.6);
        }

        .calc-title {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.2rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .calc-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .calc-input {
            background: var(--input-bg);
            border: 1px solid #475569;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 1.1rem;
            outline: none;
            width: 150px;
        }

        .calc-results-list { margin-top: 15px; }
        .calc-empty-msg { text-align: center; color: var(--text-secondary); font-style: italic; padding: 20px; }
        .loader { color: var(--text-secondary); font-size: 0.8rem; font-style: italic; padding: 10px;}

        @media (max-width: 768px) {
            .clock-container { flex-direction: column-reverse; gap: 10px; } /* En celular, fecha arriba o abajo */
            .date-display { text-align: center; font-size: 1rem; }
            .time { font-size: 2.5rem; }
            .calc-controls { flex-direction: column; align-items: stretch; }
            .calc-input, select.coin-selector { width: 100%; box-sizing: border-box; }
        }
    </style>
</head>
<body>

    <!-- RELOJ + FECHA -->
    <div class="clock-container">
        <!-- Fecha a la izquierda -->
        <div id="date-display" class="date-display">
            Cargando fecha...
        </div>

        <!-- Reloj -->
        <div id="clock" class="time">
            00:00:00<span id="millis" class="milliseconds">.000</span>
        </div>
    </div>

    <!-- PANELES CRYPTO -->
    <div class="crypto-grid">
        <!-- SLOT 1 -->
        <div class="card">
            <div class="card-header">
                <select id="select-1" class="coin-selector"></select>
                <div id="trend-1" class="trend-badge">...</div>
            </div>
            <div id="data-1" class="data-container"><div class="loader">Cargando...</div></div>
            <div id="satoshi-1" class="satoshi-box">
                <div class="satoshi-title">Valor de 1 Satoshi</div>
                <div class="satoshi-values" id="satoshi-val-1">--</div>
            </div>
        </div>
        <!-- SLOT 2 -->
        <div class="card">
            <div class="card-header">
                <select id="select-2" class="coin-selector"></select>
                <div id="trend-2" class="trend-badge">...</div>
            </div>
            <div id="data-2" class="data-container"><div class="loader">Cargando...</div></div>
            <div id="satoshi-2" class="satoshi-box">
                <div class="satoshi-title">Valor de 1 Satoshi</div>
                <div class="satoshi-values" id="satoshi-val-2">--</div>
            </div>
        </div>
        <!-- SLOT 3 -->
        <div class="card">
            <div class="card-header">
                <select id="select-3" class="coin-selector"></select>
                <div id="trend-3" class="trend-badge">...</div>
            </div>
            <div id="data-3" class="data-container"><div class="loader">Cargando...</div></div>
            <div id="satoshi-3" class="satoshi-box">
                <div class="satoshi-title">Valor de 1 Satoshi</div>
                <div class="satoshi-values" id="satoshi-val-3">--</div>
            </div>
        </div>
    </div>

    <!-- CALCULADORA DETALLADA -->
    <div class="calculator-section">
        <div class="calc-title">Conversor Multi-Exchange</div>
        <div class="calc-controls">
            <input type="number" id="calc-input" class="calc-input" placeholder="Cantidad" step="any">
            <select id="calc-select" class="coin-selector" style="width: auto; flex-grow: 1;"></select>
        </div>
        
        <div id="calc-results-list" class="calc-results-list">
            <div class="calc-empty-msg">Ingrese cantidad y moneda para ver cotización en tiempo real.</div>
        </div>
    </div>

    <script>
        // --- BASE DE DATOS Y CONFIG ---
        const COINS_DB = [
            { code: 'btc', name: 'Bitcoin', id: 'bitcoin' },
            { code: 'eth', name: 'Ethereum', id: 'ethereum' },
            { code: 'usdt', name: 'Tether (USDT)', id: 'tether' },
            { code: 'usdc', name: 'USDC', id: 'usd-coin' },
            { code: 'sol', name: 'Solana', id: 'solana' },
            { code: 'dai', name: 'Dai', id: 'dai' },
            { code: 'ada', name: 'Cardano', id: 'cardano' },
            { code: 'matic', name: 'Polygon', id: 'matic-network' },
            { code: 'dot', name: 'Polkadot', id: 'polkadot' },
            { code: 'xrp', name: 'XRP', id: 'ripple' },
            { code: 'ltc', name: 'Litecoin', id: 'litecoin' },
            { code: 'doge', name: 'Dogecoin', id: 'dogecoin' },
            { code: 'bnb', name: 'Binance Coin', id: 'binancecoin' }
        ];

        const EXCHANGES = ['binance', 'lemoncash', 'satoshitango'];
        const EX_NAMES = { 'binance': 'Binance', 'lemoncash': 'Lemon', 'satoshitango': 'S. Tango' };

        // --- INICIALIZACIÓN ---
        function init() {
            ['select-1', 'select-2', 'select-3'].forEach((id, index) => {
                populateSelect(id);
                const defaults = ['btc', 'eth', 'sol'];
                document.getElementById(id).value = defaults[index];
                document.getElementById(id).addEventListener('change', () => updateSlot(index + 1));
            });

            populateSelect('calc-select');
            document.getElementById('calc-select').value = 'btc';
            
            document.getElementById('calc-input').addEventListener('input', runDetailedCalculator);
            document.getElementById('calc-select').addEventListener('change', runDetailedCalculator);

            requestAnimationFrame(updateClock);
            refreshAllData();
        }

        function populateSelect(elementId) {
            const sel = document.getElementById(elementId);
            COINS_DB.forEach(coin => {
                const opt = document.createElement('option');
                opt.value = coin.code;
                opt.textContent = `${coin.name} (${coin.code.toUpperCase()})`;
                sel.appendChild(opt);
            });
        }

        function formatMoney(amount, currency) {
            let formatted;
            if (currency === 'ARS') {
                formatted = new Intl.NumberFormat('es-AR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(amount);
            } else {
                formatted = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(amount);
            }
            return `$ ${formatted} <span class="currency-suffix">${currency}</span>`;
        }

        // --- RELOJ Y FECHA ---
        function updateClock() {
            const now = new Date();
            
            // Hora
            const h = String(now.getHours()).padStart(2, '0');
            const m = String(now.getMinutes()).padStart(2, '0');
            const s = String(now.getSeconds()).padStart(2, '0');
            const ms = String(now.getMilliseconds()).padStart(3, '0');
            document.getElementById('clock').innerHTML = `${h}:${m}:${s}<span class="milliseconds">.${ms}</span>`;

            // Fecha (Formato: 4 de diciembre de 2025)
            const day = now.getDate();
            const month = now.toLocaleString('es-AR', { month: 'long' });
            const year = now.getFullYear();
            
            // Solo actualizamos el DOM de la fecha si cambió (para eficiencia)
            const dateStr = `${day} de ${month} de ${year}`;
            const dateEl = document.getElementById('date-display');
            if (dateEl.textContent !== dateStr) {
                dateEl.textContent = dateStr;
            }

            requestAnimationFrame(updateClock);
        }

        // --- DATOS ---
        async function refreshAllData() {
            let usdtRate = 0;
            try {
                const res = await fetch('https://criptoya.com/api/usdt/ars/0.1');
                const data = await res.json();
                usdtRate = data.lemoncash.ask || data.binance.ask;
            } catch (e) { console.error("Error USDT"); return; }

            updateSlot(1, usdtRate);
            updateSlot(2, usdtRate);
            updateSlot(3, usdtRate);
            runDetailedCalculator(null, usdtRate);
        }

        async function updateSlot(slotNum, preloadedUsdtRate = null) {
            const coinCode = document.getElementById(`select-${slotNum}`).value;
            const container = document.getElementById(`data-${slotNum}`);
            const satoshiBox = document.getElementById(`satoshi-${slotNum}`);
            
            if (coinCode === 'btc') satoshiBox.classList.add('visible');
            else satoshiBox.classList.remove('visible');

            let usdtRate = preloadedUsdtRate;
            if (!usdtRate) {
                try {
                    const r = await fetch('https://criptoya.com/api/usdt/ars/0.1');
                    const d = await r.json();
                    usdtRate = d.lemoncash.ask;
                } catch { return; }
            }

            try {
                const res = await fetch(`https://criptoya.com/api/${coinCode}/ars/0.1`);
                const data = await res.json();
                
                let html = '';
                let binanceArs = 0;

                EXCHANGES.forEach(ex => {
                    if (data[ex]) {
                        const priceArs = data[ex].ask;
                        const priceUsd = priceArs / usdtRate;
                        if(ex === 'binance') binanceArs = priceArs;

                        html += `
                            <div class="exchange-row">
                                <span class="exchange-name">${EX_NAMES[ex]}</span>
                                <div class="price-group">
                                    <div class="price-val price-ars">${formatMoney(priceArs, 'ARS')}</div>
                                    <div class="price-val price-usd">${formatMoney(priceUsd, 'USD')}</div>
                                </div>
                            </div>
                        `;
                    }
                });
                
                container.innerHTML = html || '<div class="loader">No disponible</div>';

                if (coinCode === 'btc' && binanceArs > 0) {
                    const satArs = binanceArs / 100000000;
                    const satUsd = (binanceArs / usdtRate) / 100000000;
                    
                    const satUsdFmt = new Intl.NumberFormat('en-US', {minimumFractionDigits: 6}).format(satUsd);
                    const satArsFmt = new Intl.NumberFormat('es-AR', {minimumFractionDigits: 4}).format(satArs);

                    document.getElementById(`satoshi-val-${slotNum}`).innerHTML = 
                        `<span style="color:#4ade80">$${satUsdFmt} USD</span> | <span style="color:#fff">$${satArsFmt} ARS</span>`;
                }

                fetchTrend(slotNum, coinCode);

            } catch (e) { container.innerHTML = '<div class="loader">Error...</div>'; }
        }

        async function fetchTrend(slotNum, coinCode) {
            const coinData = COINS_DB.find(c => c.code === coinCode);
            if (!coinData) return;
            const badge = document.getElementById(`trend-${slotNum}`);
            
            try {
                const res = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${coinData.id}&vs_currencies=usd&include_1h_change=true`);
                const data = await res.json();
                if (data[coinData.id]) {
                    const change = data[coinData.id].usd_1h_change;
                    const isPos = change >= 0;
                    badge.className = `trend-badge ${isPos ? 'trend-up' : 'trend-down'}`;
                    badge.innerHTML = `${isPos ? '▲' : '▼'} ${Math.abs(change).toFixed(2)}% (1h)`;
                }
            } catch (e) { badge.className = 'trend-badge trend-neutral'; badge.innerText = '-'; }
        }

        async function runDetailedCalculator(_evt, preloadedUsdtRate = null) {
            const amount = parseFloat(document.getElementById('calc-input').value);
            const coinCode = document.getElementById('calc-select').value;
            const resultContainer = document.getElementById('calc-results-list');

            if (!amount || isNaN(amount)) {
                resultContainer.innerHTML = '<div class="calc-empty-msg">Ingrese una cantidad y seleccione criptomoneda.</div>';
                return;
            }

            if (!_evt && !preloadedUsdtRate) resultContainer.innerHTML = '<div class="loader" style="text-align:center">Calculando...</div>';

            try {
                let usdtRate = preloadedUsdtRate;
                if (!usdtRate) {
                    const r = await fetch('https://criptoya.com/api/usdt/ars/0.1');
                    const d = await r.json();
                    usdtRate = d.lemoncash.ask;
                }

                const rCoin = await fetch(`https://criptoya.com/api/${coinCode}/ars/0.1`);
                const dataCoin = await rCoin.json();

                let html = '';
                
                EXCHANGES.forEach(ex => {
                    if (dataCoin[ex]) {
                        const unitPriceArs = dataCoin[ex].ask;
                        const totalArs = unitPriceArs * amount;
                        const totalUsd = (unitPriceArs / usdtRate) * amount;

                        html += `
                            <div class="exchange-row" style="background: rgba(0,0,0,0.4); border: 1px solid #475569; padding:15px;">
                                <span class="exchange-name" style="font-size: 1.1rem; color: #cbd5e1;">${EX_NAMES[ex]}</span>
                                <div class="price-group">
                                    <div class="price-val price-ars" style="font-size: 1.3rem;">
                                        ${formatMoney(totalArs, 'ARS')}
                                    </div>
                                    <div class="price-val price-usd" style="font-size: 1rem;">
                                        ${formatMoney(totalUsd, 'USD')}
                                    </div>
                                </div>
                            </div>
                        `;
                    }
                });

                if (html === '') html = '<div class="calc-empty-msg">Sin datos disponibles.</div>';
                resultContainer.innerHTML = html;

            } catch (e) { console.error(e); }
        }

        init();
        setInterval(refreshAllData, 10000);

    </script>
</body>
</html>